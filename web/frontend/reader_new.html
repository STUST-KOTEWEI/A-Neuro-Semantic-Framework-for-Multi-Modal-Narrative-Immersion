<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Modern Reader - ç¾ä»£é–±è®€å™¨</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,system-ui,sans-serif;background:#0a0e27;color:#e2e8f0;line-height:1.5}
    .container{max-width:420px;margin:0 auto;padding:1rem;min-height:100vh}
    .header{text-align:center;margin-bottom:2rem;padding-top:2rem}
    .logo{font-size:1.75rem;font-weight:700;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:.5rem}
    .tagline{font-size:.85rem;color:#94a3b8;margin-bottom:1.5rem}
    .card{background:#1e293b;border:1px solid #334155;border-radius:16px;padding:1.5rem;margin-bottom:1.5rem;box-shadow:0 4px 12px rgba(0,0,0,.3)}
    .tabs{display:flex;background:#0f172a;border-radius:12px;padding:.25rem;margin-bottom:1.5rem}
    .tab{flex:1;text-align:center;padding:.75rem;border-radius:10px;font-weight:600;font-size:.9rem;cursor:pointer;transition:all .2s}
    .tab.active{background:#2563eb;color:#fff;transform:translateY(-1px)}
    .form-group{margin-bottom:1rem}
    label{display:block;font-size:.8rem;font-weight:600;margin-bottom:.5rem;color:#cbd5e1}
    input,select,textarea{width:100%;border:2px solid #334155;border-radius:10px;background:#0f172a;color:#e2e8f0;padding:.75rem;font-size:.9rem;transition:border-color .2s}
    input:focus,select:focus,textarea:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 3px rgba(37,99,235,.1)}
    .btn{width:100%;border:none;background:linear-gradient(135deg,#2563eb 0%,#3b82f6 100%);color:#fff;padding:.85rem;border-radius:12px;font-weight:600;font-size:.9rem;cursor:pointer;transition:all .2s}
    .btn:hover{transform:translateY(-1px);box-shadow:0 6px 20px rgba(37,99,235,.3)}
    .btn.sec{background:#475569}
    .btn:disabled{opacity:.5;cursor:not-allowed;transform:none}
    .alert{padding:.75rem;border-radius:10px;margin-bottom:1rem;font-size:.85rem;display:none}
    .alert.error{background:#7f1d1d;color:#fca5a5;border:1px solid #991b1b}
    .alert.success{background:#14532d;color:#86efac;border:1px solid #166534}
    .user-panel{display:none}
    .user-info{display:flex;align-items:center;gap:.75rem;margin-bottom:1rem}
    .status-badge{padding:.25rem .6rem;border-radius:20px;font-size:.7rem;font-weight:600}
    .status-free{background:#475569;color:#e2e8f0}
    .status-pro{background:#fbbf24;color:#1f2937}
    .feature-grid{display:grid;grid-template-columns:1fr 1fr;gap:.75rem;margin:1.5rem 0}
    .feature-btn{background:#334155;border:none;color:#e2e8f0;padding:.75rem;border-radius:10px;font-size:.8rem;cursor:pointer;transition:all .2s}
    .feature-btn:hover{background:#475569;transform:translateY(-1px)}
    .debug-panel{background:#0f172a;border:1px solid #1e293b;border-radius:10px;padding:1rem;margin-top:1rem}
    .debug-log{font-family:ui-monospace,monospace;font-size:.7rem;max-height:150px;overflow-y:auto;white-space:pre-wrap;color:#94a3b8}
    .footer{text-align:center;margin-top:2rem;padding:1rem;font-size:.7rem;color:#64748b}
    .hidden{display:none !important}
  </style>
</head>
<body>
  <div class="container">
    <header style="padding:1.5rem 0 1rem 0;text-align:center">
      <h1 style="font-size:2rem;font-weight:700;color:#2563eb;margin-bottom:.5rem">Modern Reader</h1>
      <div style="color:#64748b;font-size:.95rem">ç¾ä»£é–±è®€ â€¢ æ™ºèƒ½åˆ†æ â€¢ å¤šæ„Ÿå®˜é«”é©—</div>
    </header>

    <nav style="display:flex;justify-content:center;gap:2rem;margin-bottom:2rem">
      <button class="btn" id="navHome">é¦–é </button>
      <button class="btn" id="navFeatures">åŠŸèƒ½</button>
      <button class="btn" id="navLogin">ç™»å…¥/è¨»å†Š</button>
    </nav>

    <main id="mainHome">
      <section style="max-width:600px;margin:0 auto;text-align:left;padding:1rem 0">
        <h2 style="font-size:1.3rem;color:#2563eb;margin-bottom:.5rem">æ­¡è¿ä½¿ç”¨ Modern Reader</h2>
        <p style="color:#94a3b8;margin-bottom:1.5rem">æœ¬å¹³å°æä¾›å¤šæ„Ÿå®˜ AI é–±è®€é«”é©—ï¼Œæ”¯æ´ NLP åˆ†æã€RAG æœåœ–ã€èªéŸ³éŒ„éŸ³/æ’­æ”¾ã€ISBN å°é¢æŸ¥è©¢èˆ‡æ•¸æ“šè¨˜éŒ„ã€‚å¯ç›´æ¥ç€è¦½åŠŸèƒ½ï¼Œæˆ–é¸æ“‡ç™»å…¥ä»¥è§£é–é€²éšåŠŸèƒ½ã€‚</p>
        <ul style="list-style:disc inside;color:#e2e8f0;font-size:.98rem">
          <li>ç„¡éœ€è¨»å†Šå³å¯é«”é©—å¤§éƒ¨åˆ†åŠŸèƒ½</li>
          <li>ç™»å…¥å¾Œå¯ä¿å­˜å€‹äººåŒ–ç´€éŒ„èˆ‡é€²éšæŸ¥è©¢</li>
        </ul>
      </section>
    </main>

    <main id="mainFeatures" style="display:none">
      <section style="max-width:600px;margin:0 auto;padding:1rem 0">
        <h2 style="font-size:1.2rem;color:#2563eb;margin-bottom:1rem">åŠŸèƒ½åˆ—è¡¨</h2>
        <div style="display:flex;flex-direction:column;gap:1rem">
          <button class="btn" id="btnNLP">ğŸ“ NLPåˆ†æ</button>
          <button class="btn" id="btnRAG">ğŸ” RAGæœåœ–</button>
          <button class="btn" id="btnSTT">ğŸ™ï¸ STTéŒ„éŸ³</button>
          <button class="btn" id="btnTTS">ğŸ”Š TTSæ’­æ”¾</button>
          <button class="btn" id="btnISBN">ğŸ“š ISBNå°é¢</button>
          <button class="btn" id="btnData">ğŸ“Š æ•¸æ“šè¨˜éŒ„</button>
        </div>
      </section>
    </main>

    <main id="mainLogin" style="display:none">
      <section style="max-width:400px;margin:0 auto;padding:1rem 0">
        <h2 style="font-size:1.2rem;color:#2563eb;margin-bottom:1rem">ç™»å…¥ / è¨»å†Š</h2>
        <div id="alertBox" class="alert"></div>
        <form id="loginForm">
          <div class="form-group">
            <label>å¸³è™Ÿ (Email æˆ– Username)</label>
            <input id="loginId" placeholder="è¼¸å…¥ email æˆ– username" />
          </div>
          <div class="form-group">
            <label>å¯†ç¢¼</label>
            <input id="loginPwd" type="password" />
          </div>
          <button type="submit" class="btn">ç™»å…¥</button>
          <button type="button" class="btn sec" id="quickFill" style="margin-top:.5rem">æ¸¬è©¦å¸³è™Ÿ</button>
        </form>
        <form id="registerForm" class="hidden">
          <div class="form-group">
            <label>Email</label>
            <input id="regEmail" type="email" />
          </div>
          <div class="form-group">
            <label>Username</label>
            <input id="regUsername" />
          </div>
          <div class="form-group">
            <label>å¯†ç¢¼</label>
            <input id="regPassword" type="password" />
          </div>
          <div class="form-group">
            <label>è¨‚é–±æ–¹æ¡ˆ</label>
            <select id="regTier">
              <option value="free">Free</option>
              <option value="plus">Plus</option>
              <option value="pro">Pro</option>
            </select>
          </div>
          <button type="submit" class="btn">å»ºç«‹å¸³è™Ÿ</button>
        </form>
        <div style="text-align:center;margin-top:1rem;color:#94a3b8;font-size:.85rem">
          <span>æˆ–ç›´æ¥ä»¥ <b>è¨ªå®¢</b> èº«ä»½ç€è¦½åŠŸèƒ½</span>
        </div>
      </section>
    </main>

    <div class="debug-panel">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem">
        <span style="font-size:.8rem;font-weight:600">Debug Log</span>
        <button class="btn sec" id="clearLog" style="padding:.25rem .5rem;font-size:.7rem">æ¸…é™¤</button>
      </div>
      <div class="debug-log" id="debugLog"></div>
    </div>

    <footer class="footer">
      Modern Reader v2.0 â€¢ <a href="/health" style="color:#38bdf8">Health Check</a>
    </footer>
  </div>
              <button class="btn sec" id="clearLog" style="padding:.25rem .5rem;font-size:.7rem">æ¸…é™¤</button>
            </div>
            <div class="debug-log" id="debugLog"></div>
          </div>

          <div class="footer">
            Modern Reader v2.0 â€¢ è¼•é‡ç‰ˆ â€¢ <a href="/health" style="color:#38bdf8">Health Check</a>
          </div>
        </div>
      </div>
    </div>
    <!-- ...existing code... -->
    <script>
    // ...åŸæœ¬ JS å…§å®¹æ”¾é€™è£¡...
    const $ = s => document.querySelector(s);
    const log = (...args) => {
      const msg = args.map(a => typeof a === 'object' ? JSON.stringify(a) : a).join(' ');
      $('#debugLog').textContent += `[${new Date().toLocaleTimeString()}] ${msg}\n`;
      $('#debugLog').scrollTop = $('#debugLog').scrollHeight;
    };
    const showAlert = (msg, type = 'error') => {
      const alert = $('#alertBox');
      alert.textContent = msg;
      alert.className = `alert ${type}`;
      alert.style.display = 'block';
      setTimeout(() => alert.style.display = 'none', 5000);
    };
    
    // API åŸºç¤è·¯å¾‘è‡ªå‹•åµæ¸¬ï¼ˆæœ¬åœ°æ¸¬è©¦ç”¨ï¼‰
    const API_BASE = window.location.port === '8010' ? '' : 'http://localhost:8010';
    
    let token = null;
    let user = null;
    
    // ç­‰å¾… DOM å®Œå…¨è¼‰å…¥
    document.addEventListener('DOMContentLoaded', () => {
      log(`API åŸºç¤è·¯å¾‘: ${API_BASE || '(ç›¸å°è·¯å¾‘)'}`);
      
      // å°èˆªåŠŸèƒ½
      $('#navHome')?.addEventListener('click', () => {
        $('#mainHome').style.display = 'block';
        $('#mainFeatures').style.display = 'none';
        $('#mainLogin').style.display = 'none';
        log('å°èˆªè‡³ï¼šé¦–é ');
      });
      
      $('#navFeatures')?.addEventListener('click', () => {
        $('#mainHome').style.display = 'none';
        $('#mainFeatures').style.display = 'block';
        $('#mainLogin').style.display = 'none';
        log('å°èˆªè‡³ï¼šåŠŸèƒ½åˆ—è¡¨');
      });
      
      $('#navLogin')?.addEventListener('click', () => {
        $('#mainHome').style.display = 'none';
        $('#mainFeatures').style.display = 'none';
        $('#mainLogin').style.display = 'block';
        log('å°èˆªè‡³ï¼šç™»å…¥/è¨»å†Š');
      });
      
      // åŠŸèƒ½æŒ‰éˆ• - å¾ SQL è®€å–ä¸¦é¡¯ç¤ºå¯¦éš›æ•¸æ“š
      
      // ğŸ“ NLPåˆ†æ - å¾ SQL è®€å– NLP åˆ†æçµæœ
      $('#btnNLP')?.addEventListener('click', async () => {
        log('æ­£åœ¨å¾ SQL è®€å– NLP åˆ†æçµæœ...');
        try {
          const resp = await fetch(`${API_BASE}/data/nlp`);
          if (!resp.ok) throw new Error(`API å›æ‡‰å¤±æ•—: ${resp.status}`);
          const data = await resp.json();
          log('=== NLP åˆ†æçµæœ ===');
          data.data.forEach(item => {
            log(`æ–‡æœ¬: "${item.text}"`);
            log(`åˆ†æé¡å‹: ${item.analysis_type}`);
            log(`çµæœ: ${JSON.stringify(item.result, null, 2)}`);
            log('---');
          });
          showAlert(`å·²è¼‰å…¥ ${data.data.length} ç­† NLP åˆ†æçµæœ`, 'success');
        } catch (e) {
          log('è®€å– NLP æ•¸æ“šå¤±æ•—:', e.message);
          showAlert('è®€å– NLP æ•¸æ“šå¤±æ•—', 'error');
        }
      });
      
      // ğŸ” RAGæœåœ– - å¾ SQL è®€å–åœ–åƒæ•¸æ“š
      $('#btnRAG')?.addEventListener('click', async () => {
        log('æ­£åœ¨å¾ SQL è®€å– RAG åœ–åƒæ•¸æ“š...');
        try {
          const resp = await fetch(`${API_BASE}/data/rag-images`);
          if (!resp.ok) throw new Error(`API å›æ‡‰å¤±æ•—: ${resp.status}`);
          const data = await resp.json();
          log('=== RAG æœåœ–çµæœ ===');
          data.data.forEach(item => {
            log(`æŸ¥è©¢: "${item.query}"`);
            log(`åœ–ç‰‡ URL: ${item.image_url}`);
            log(`æè¿°: ${item.description}`);
            log(`ç›¸é—œåº¦: ${item.relevance_score}`);
            log('---');
          });
          showAlert(`å·²è¼‰å…¥ ${data.data.length} å¼µåœ–åƒæ•¸æ“š`, 'success');
        } catch (e) {
          log('è®€å– RAG åœ–åƒå¤±æ•—:', e.message);
          showAlert('è®€å– RAG åœ–åƒå¤±æ•—', 'error');
        }
      });
      
      // ğŸ™ï¸ STTéŒ„éŸ³ - å¾ SQL è®€å–æƒ…æ„Ÿåµæ¸¬æ•¸æ“š
      $('#btnSTT')?.addEventListener('click', async () => {
        log('æ­£åœ¨å¾ SQL è®€å–æƒ…æ„Ÿåµæ¸¬æ•¸æ“š...');
        try {
          const resp = await fetch(`${API_BASE}/data/emotions`);
          if (!resp.ok) throw new Error(`API å›æ‡‰å¤±æ•—: ${resp.status}`);
          const data = await resp.json();
          log('=== æƒ…æ„Ÿåµæ¸¬çµæœ ===');
          data.data.forEach(item => {
            log(`æ–‡æœ¬: "${item.audio_text}"`);
            log(`æƒ…æ„Ÿ: ${item.emotion} (ä¿¡å¿ƒåº¦: ${(item.confidence * 100).toFixed(1)}%)`);
            log(`æ™‚é–“: ${item.timestamp}`);
            log('---');
          });
          showAlert(`å·²è¼‰å…¥ ${data.data.length} ç­†æƒ…æ„Ÿåµæ¸¬æ•¸æ“š`, 'success');
        } catch (e) {
          log('è®€å–æƒ…æ„Ÿæ•¸æ“šå¤±æ•—:', e.message);
          showAlert('è®€å–æƒ…æ„Ÿæ•¸æ“šå¤±æ•—', 'error');
        }
      });
      
      // ğŸ”Š TTSæ’­æ”¾ - å¾ SQL è®€å–æ’­å®¢å…§å®¹
      $('#btnTTS')?.addEventListener('click', async () => {
        log('æ­£åœ¨å¾ SQL è®€å–æ’­å®¢å…§å®¹...');
        try {
          const resp = await fetch(`${API_BASE}/data/podcasts`);
          if (!resp.ok) throw new Error(`API å›æ‡‰å¤±æ•—: ${resp.status}`);
          const data = await resp.json();
          log('=== æ’­å®¢å…§å®¹åˆ—è¡¨ ===');
          data.data.forEach(item => {
            log(`æ¨™é¡Œ: ${item.title}`);
            log(`å…§å®¹: ${item.content}`);
            log(`éŸ³è¨Š URL: ${item.audio_url}`);
            log(`æ™‚é•·: ${Math.floor(item.duration / 60)} åˆ† ${item.duration % 60} ç§’`);
            log('---');
          });
          showAlert(`å·²è¼‰å…¥ ${data.data.length} å€‹æ’­å®¢å…§å®¹`, 'success');
        } catch (e) {
          log('è®€å–æ’­å®¢å…§å®¹å¤±æ•—:', e.message);
          showAlert('è®€å–æ’­å®¢å…§å®¹å¤±æ•—', 'error');
        }
      });
      
      // ğŸ“š ISBNå°é¢ - å¾ SQL è®€å–æ›¸ç±å°é¢åœ–åƒ
      $('#btnISBN')?.addEventListener('click', async () => {
        log('æ­£åœ¨å¾ SQL è®€å–æ›¸ç±å°é¢æ•¸æ“š...');
        try {
          const resp = await fetch(`${API_BASE}/data/book-covers`);
          if (!resp.ok) throw new Error(`API å›æ‡‰å¤±æ•—: ${resp.status}`);
          const data = await resp.json();
          log('=== æ›¸ç±å°é¢åˆ—è¡¨ ===');
          data.data.forEach(item => {
            log(`ISBN: ${item.isbn}`);
            log(`æ›¸å: ${item.title}`);
            log(`ä½œè€…: ${item.author}`);
            log(`å°é¢åœ–: ${item.cover_image_url}`);
            log(`ç°¡ä»‹: ${item.description}`);
            log('---');
          });
          showAlert(`å·²è¼‰å…¥ ${data.data.length} æœ¬æ›¸ç±å°é¢`, 'success');
        } catch (e) {
          log('è®€å–æ›¸ç±å°é¢å¤±æ•—:', e.message);
          showAlert('è®€å–æ›¸ç±å°é¢å¤±æ•—', 'error');
        }
      });
      
      // ğŸ“Š æ•¸æ“šè¨˜éŒ„ - å¾ SQL è®€å–ç”¨æˆ¶æ•¸æ“š
      $('#btnData')?.addEventListener('click', async () => {
        log('æ­£åœ¨å¾ SQL è®€å–ç”¨æˆ¶æ•¸æ“š...');
        try {
          const resp = await fetch(`${API_BASE}/data/users`);
          if (!resp.ok) throw new Error(`API å›æ‡‰å¤±æ•—: ${resp.status}`);
          const data = await resp.json();
          log('=== ç”¨æˆ¶æ•¸æ“šåˆ—è¡¨ ===');
          data.data.forEach(item => {
            log(`ID: ${item.id} | ${item.username} (${item.email})`);
            log(`è¨‚é–±æ–¹æ¡ˆ: ${item.subscription_tier}`);
            log('---');
          });
          showAlert(`å·²è¼‰å…¥ ${data.data.length} ç­†ç”¨æˆ¶æ•¸æ“š`, 'success');
        } catch (e) {
          log('è®€å–ç”¨æˆ¶æ•¸æ“šå¤±æ•—:', e.message);
          showAlert('è®€å–ç”¨æˆ¶æ•¸æ“šå¤±æ•—', 'error');
        }
      });
      
      // æ¸…é™¤ log æŒ‰éˆ•
      $('#clearLog')?.addEventListener('click', () => {
        $('#debugLog').textContent = '';
        log('Debug log å·²æ¸…é™¤');
      });
      
      log('é é¢å·²è¼‰å…¥ï¼Œæ‰€æœ‰åŠŸèƒ½å·²åˆå§‹åŒ–');
    });
    </script>
</body>
</html>