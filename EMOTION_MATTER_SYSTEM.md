# æƒ…ç·’é©…å‹•å¯ç·¨ç¨‹ç‰©è³ªç”Ÿæˆç³»çµ±

## ğŸ¯ ç³»çµ±æ¦‚è¿°

é€™æ˜¯ä¸€å€‹æ•´åˆé¡é ­è¡¨æƒ…æ„Ÿæ¸¬ã€RAG åœ–åƒç”Ÿæˆã€Google Gemini AI è£œå……ç”Ÿæˆã€ä»¥åŠå¯ç·¨ç¨‹ç‰©è³ªæ¨¡æ“¬çš„å®Œæ•´ç³»çµ±ã€‚

### æ ¸å¿ƒç‰¹æ€§

1. **é¡é ­è¡¨æƒ…æª¢æ¸¬** ğŸ“·
   - å¯¦æ™‚æ•ç²ç”¨æˆ¶è¡¨æƒ…
   - ä½¿ç”¨ Google Gemini Vision API åˆ†ææƒ…ç·’
   - æª¢æ¸¬ä¸»è¦æƒ…ç·’ã€å¼·åº¦ã€æ¬¡è¦æƒ…ç·’ã€è¡¨æƒ…ç‰¹å¾µ
   - æ”¯æ´çš„æƒ…ç·’ï¼šhappy, sad, angry, fear, surprise, disgust, neutral

2. **æ··åˆåœ–åƒç”Ÿæˆ** ğŸ¨
   - **RAG ç”Ÿæˆ**ï¼šæœ€å¤š 50 å¼µåœ–åƒï¼ˆå¾è³‡æ–™åº«æˆ–åŸºæ–¼æŸ¥è©¢ç”Ÿæˆï¼‰
   - **Gemini è£œå……**ï¼šå‰©é¤˜æ•¸é‡ç”± Google AI ç”Ÿæˆ
   - æ¯å¼µåœ–åƒåŒ…å«æƒ…ç·’ä¸Šä¸‹æ–‡ã€æ¨™ç±¤ã€ç”Ÿæˆ prompt

3. **å¯ç·¨ç¨‹ç‰©è³ªæ¨¡æ“¬** ğŸŒŠ
   - æ ¹æ“šæª¢æ¸¬åˆ°çš„æƒ…ç·’å‹•æ…‹èª¿æ•´åƒæ•¸
   - åƒæ•¸åŒ…æ‹¬ï¼šå¯†åº¦ã€é»åº¦ã€é¡è‰²ã€é‹å‹•æ¨¡å¼ã€è½‰æ›é€Ÿåº¦
   - å³æ™‚è¦–è¦ºåŒ–ç²’å­ç³»çµ±
   - 6 ç¨®é‹å‹•æ¨¡å¼ï¼šbubble, drip, spike, scatter, burst, flow

## ğŸ“ æª”æ¡ˆçµæ§‹

```text
/Users/kedewei/AI-Reader/
â”œâ”€â”€ backend/
â”‚   â””â”€â”€ emotion_based_generator.py      # æ ¸å¿ƒç”Ÿæˆå¼•æ“
â”œâ”€â”€ web/frontend/
â”‚   â””â”€â”€ emotion_matter_generator.html   # å‰ç«¯ä»‹é¢
â”œâ”€â”€ integrated_server.py                 # FastAPI å¾Œç«¯æœå‹™å™¨
â”œâ”€â”€ test_emotion_system.py              # æ•´åˆæ¸¬è©¦è…³æœ¬
â””â”€â”€ modernreader.db                     # SQLite è³‡æ–™åº«

```text

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. å•Ÿå‹•å¾Œç«¯æœå‹™å™¨

```bash
cd /Users/kedewei/AI-Reader
.venv/bin/python -m uvicorn integrated_server:app --host 0.0.0.0 --port 8010 --reload

```text

### 2. æ‰“é–‹å‰ç«¯ä»‹é¢

åœ¨ç€è¦½å™¨è¨ªå•ï¼š

```bash
http://localhost:8010/web/emotion_matter_generator.html

```text

### 3. ä½¿ç”¨æµç¨‹

1. **å•Ÿå‹•é¡é ­**
   - é»æ“Šã€Œå•Ÿå‹•é¡é ­ã€æŒ‰éˆ•
   - å…è¨±ç€è¦½å™¨ä½¿ç”¨é¡é ­æ¬Šé™

2. **æ•ç²è¡¨æƒ…**
   - å°è‘—é¡é ­åšå‡ºè¡¨æƒ…
   - é»æ“Šã€Œæ•ç²è¡¨æƒ…ã€æŒ‰éˆ•
   - ç³»çµ±æœƒåˆ†ææ‚¨çš„æƒ…ç·’

3. **è¨­å®šåƒæ•¸**
   - è¼¸å…¥æŸ¥è©¢ä¸»é¡Œï¼ˆä¾‹å¦‚ï¼šæœªä¾†ç§‘æŠ€ã€è‡ªç„¶é¢¨æ™¯ï¼‰
   - è¨­å®šç¸½åœ–åƒæ•¸é‡ï¼ˆ50-200ï¼‰
   - RAG åœ–åƒæ•¸é‡å›ºå®šç‚º 50

4. **é–‹å§‹ç”Ÿæˆ**
   - é»æ“Šã€Œé–‹å§‹ç”Ÿæˆã€æŒ‰éˆ•
   - ç­‰å¾…é€²åº¦æ¢å®Œæˆ
   - æŸ¥çœ‹ç”Ÿæˆçµæœ

## ğŸ”Œ API ç«¯é»

### 1. è¡¨æƒ…æª¢æ¸¬

**ç«¯é»**: `POST /api/detect-emotion`

**è«‹æ±‚é«”**:

```json
{
  "image_base64": "base64_encoded_image_data"
}

```text

**å›æ‡‰**:

```json
{
  "primary_emotion": "happy",
  "intensity": 0.85,
  "secondary_emotions": ["excited", "calm"],
  "facial_features": "ç¬‘å®¹æ˜é¡¯ï¼Œçœ¼ç›å½æ›²",
  "timestamp": 1697355789,
  "status": "detected"
}

```text

### 2. å®Œæ•´ç”Ÿæˆ

**ç«¯é»**: `POST /api/generate-complete`

**è«‹æ±‚é«”**:

```json
{
  "camera_image_base64": "base64_encoded_image_data",
  "query": "æœªä¾†ç§‘æŠ€",
  "total_count": 100
}

```text

**å›æ‡‰**:

```json
{
  "emotion": {
    "primary_emotion": "happy",
    "intensity": 0.85,
    "secondary_emotions": ["excited"],
    "status": "detected"
  },
  "rag_images": [
    {
      "id": "rag_1",
      "url": "https://...",
      "caption": "RAG ç”Ÿæˆåœ–åƒ #1",
      "tags": ["happy", "tech"],
      "source": "RAG",
      "emotion_context": "happy"
    }
  ],
  "gemini_images": [
    {
      "id": "gemini_51",
      "url": "https://...",
      "caption": "Gemini ç”Ÿæˆåœ–åƒ #51",
      "tags": ["happy", "tech", "AI"],
      "source": "Gemini",
      "prompt": "creative prompt...",
      "programmable_matter": {
        "density": 0.4,
        "viscosity": 0.3,
        "color": [255, 220, 100],
        "motion_pattern": "bubble",
        "transformation_speed": 0.7
      }
    }
  ],
  "all_images": [...],
  "programmable_matter_config": {
    "emotion_base": "happy",
    "intensity": 0.85,
    "global_params": {...},
    "image_count": 100,
    "rag_count": 50,
    "gemini_count": 50
  },
  "statistics": {
    "total_images": 100,
    "rag_images": 50,
    "gemini_images": 50,
    "emotion": "happy",
    "intensity": 0.85,
    "query": "æœªä¾†ç§‘æŠ€",
    "timestamp": 1697355789
  }
}

```text

## ğŸ¨ å¯ç·¨ç¨‹ç‰©è³ªåƒæ•¸

### æƒ…ç·’æ˜ å°„

| æƒ…ç·’ | å¯†åº¦ | é»åº¦ | é¡è‰² (RGB) | é‹å‹•æ¨¡å¼ |
|------|------|------|------------|----------|
| happy | 0.3 | 0.2 | [255, 220, 100] | bubble (ä¸Šæµ®) |
| sad | 0.8 | 0.9 | [100, 150, 200] | drip (ä¸‹æ»´) |
| angry | 0.9 | 0.3 | [255, 50, 50] | spike (å°–åˆº) |
| fear | 0.4 | 0.7 | [150, 100, 200] | scatter (æ•£å°„) |
| surprise | 0.5 | 0.1 | [255, 200, 0] | burst (çˆ†ç™¼) |
| disgust | 0.7 | 0.8 | [150, 200, 100] | recoil (å¾Œé€€) |
| neutral | 0.5 | 0.5 | [200, 200, 200] | flow (æµå‹•) |

### å‹•ç•«æ•ˆæœ

- **bubble**: ç²’å­å‘ä¸Šæµ®å‹•ï¼Œè¼•ç›ˆæ„Ÿ
- **drip**: ç²’å­å‘ä¸‹æ»´è½ï¼Œæ²‰é‡æ„Ÿ
- **spike**: ç²’å­å¾ä¸­å¿ƒå‘å¤–æ“´æ•£ï¼Œæ¿€çƒˆæ„Ÿ
- **scatter**: ç²’å­éš¨æ©Ÿæ•£å°„ï¼Œä¸å®‰æ„Ÿ
- **burst**: ç²’å­çˆ†ç™¼å¼æ“´æ•£ï¼Œé©šè¨æ„Ÿ
- **recoil**: ç²’å­å‘å¾Œæ”¶ç¸®ï¼Œå­æƒ¡æ„Ÿ
- **flow**: ç²’å­å¹³ç©©æµå‹•ï¼Œå¹³éœæ„Ÿ

## ğŸ§ª æ¸¬è©¦

åŸ·è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶ï¼š

```bash
.venv/bin/python test_emotion_system.py

```text

æ¸¬è©¦åŒ…æ‹¬ï¼š

1. âœ… è¡¨æƒ…æª¢æ¸¬ API
2. âœ… å®Œæ•´ç”Ÿæˆæµç¨‹ï¼ˆRAG 50 + Gemini 30ï¼‰
3. âœ… è³‡æ–™åº«æ•¸æ“šæª¢æŸ¥

## ğŸ”§ è¨­å®š Gemini API Key

å¦‚æœè¦å•Ÿç”¨çœŸå¯¦çš„ Google Gemini æƒ…ç·’æª¢æ¸¬å’Œåœ–åƒç”Ÿæˆï¼Œéœ€è¦è¨­å®š API Keyï¼š

```bash
export GEMINI_API_KEY="your_api_key_here"

```text

æˆ–åœ¨ `backend/emotion_based_generator.py` ä¸­è¨­å®šã€‚

## ğŸ“Š è³‡æ–™åº«çµæ§‹

ç³»çµ±ä½¿ç”¨ SQLite è³‡æ–™åº« (`modernreader.db`)ï¼ŒåŒ…å«ä»¥ä¸‹è¡¨ï¼š

1. **users** - ç”¨æˆ¶è³‡æ–™
2. **emotion_detections** - è¡¨æƒ…æª¢æ¸¬è¨˜éŒ„
3. **rag_images** - RAG ç”Ÿæˆçš„åœ–åƒ
4. **book_covers** - ISBN æ›¸ç±å°é¢
5. **podcast_contents** - æ’­å®¢å…§å®¹
6. **nlp_analyses** - NLP åˆ†æçµæœ

## ğŸ¯ ä½¿ç”¨æƒ…å¢ƒ

### æƒ…å¢ƒ 1: æ ¹æ“šå¿ƒæƒ…æ¨è–¦é–±è®€å…§å®¹

```text
ç”¨æˆ¶ç¬‘å®¹ (happy) â†’ ç”Ÿæˆè¼•é¬†ã€æœ‰è¶£çš„å…§å®¹åœ–åƒ
ç”¨æˆ¶çšºçœ‰ (sad) â†’ ç”Ÿæˆæº«æš–ã€ç™‚ç™’çš„å…§å®¹åœ–åƒ

```text

### æƒ…å¢ƒ 2: æƒ…ç·’æ—¥è¨˜è¦–è¦ºåŒ–

```text
æ•ç²æ¯æ—¥è¡¨æƒ… â†’ è¨˜éŒ„æƒ…ç·’è®ŠåŒ– â†’ ç”Ÿæˆå€‹æ€§åŒ–è¦–è¦ºæ—¥è¨˜

```text

### æƒ…å¢ƒ 3: æ²‰æµ¸å¼é–±è®€é«”é©—

```text
æª¢æ¸¬é–±è®€æ™‚çš„æƒ…ç·’ â†’ å‹•æ…‹èª¿æ•´å¯ç·¨ç¨‹ç‰©è³ªæ•ˆæœ â†’ å¢å¼·é–±è®€æ°›åœ

```text

## ğŸš€ æœªä¾†æ“´å±•

- [ ] æ”¯æ´å¤šäººåŒæ™‚æª¢æ¸¬
- [ ] åŠ å…¥éŸ³æ¨‚æ¨è–¦ï¼ˆæ ¹æ“šæƒ…ç·’ï¼‰
- [ ] 3D å¯ç·¨ç¨‹ç‰©è³ªè¦–è¦ºåŒ–ï¼ˆThree.jsï¼‰
- [ ] æƒ…ç·’æ­·å²è¿½è¹¤èˆ‡åˆ†æ
- [ ] VR/AR æ•´åˆ
- [ ] å¯¦æ™‚æƒ…ç·’æµå‹•é æ¸¬
- [ ] ç¤¾äº¤æƒ…ç·’åˆ†äº«åŠŸèƒ½

## ğŸ“ æ¸¬è©¦çµæœ

```text
âœ… æ‰€æœ‰æ¸¬è©¦é€šéï¼

ğŸ“Š çµ±è¨ˆè³‡è¨Š:

  - ç¸½åœ–åƒæ•¸: 80
  - RAG ç”Ÿæˆ: 50
  - Gemini è£œå……: 30
  - ä¸»è¦æƒ…ç·’: neutral
  - æƒ…ç·’å¼·åº¦: 0.5

ğŸŒŠ å¯ç·¨ç¨‹ç‰©è³ªé…ç½®:

  - æƒ…ç·’åŸºç¤: neutral
  - å¯†åº¦: 0.4
  - é»åº¦: 0.4
  - é¡è‰²: [200, 200, 200]
  - é‹å‹•æ¨¡å¼: flow

```text

## ğŸ’¡ æŠ€è¡“äº®é»

1. **WebRTC** - å³æ™‚é¡é ­æ•ç²
2. **Canvas API** - åœ–åƒè™•ç†èˆ‡ç²’å­å‹•ç•«
3. **Google Gemini Vision** - è¡¨æƒ…åˆ†æ
4. **FastAPI** - é«˜æ€§èƒ½å¾Œç«¯
5. **SQLite** - è¼•é‡ç´šæ•¸æ“šå­˜å„²
6. **Responsive Design** - é©é…å„ç¨®è¢å¹•å°ºå¯¸

## ğŸ“ æ”¯æ´

å¦‚æœ‰å•é¡Œï¼Œè«‹æª¢æŸ¥ï¼š

1. æœå‹™å™¨æ˜¯å¦æ­£å¸¸é‹è¡Œï¼ˆç«¯å£ 8010ï¼‰
2. ç€è¦½å™¨æ˜¯å¦å…è¨±é¡é ­æ¬Šé™
3. API Key æ˜¯å¦æ­£ç¢ºè¨­å®šï¼ˆå¦‚ä½¿ç”¨çœŸå¯¦ Gemini APIï¼‰

---

**ç‰ˆæœ¬**: 1.0.0
**å»ºç«‹æ—¥æœŸ**: 2025-10-15
**ä½œè€…**: AI-Reader Team

